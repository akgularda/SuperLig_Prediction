% !TeX program = pdflatex
\documentclass[11pt]{article}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{booktabs}
\usepackage{siunitx}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{enumitem}
\usepackage{multirow}
\usepackage{xcolor}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{mathtools}
\hypersetup{colorlinks=true,linkcolor=blue,citecolor=blue,urlcolor=blue}
\sisetup{detect-weight=true,detect-family=true}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{definition}{Definition}
\newtheorem{corollary}{Corollary}

\title{A Bayesian Hierarchical Framework for Football League Prediction: \\Mathematical Foundations and Empirical Validation \\on the Turkish S\"uper Lig Dataset}
\author{\textbf{Arda Akg√ºl} \\ [Monarch Castle Technologies] \\ \texttt{ardakgul4@gmail.com}}
\date{August 16, 2025}

\begin{document}
\maketitle
\begin{abstract}
We present a data-driven forecasting framework for the 2025--26 Turkish S\"uper Lig that combines historical performance modeling (1958--2020, 18{,}079 matches) with current-season factors through a calibrated Club Strength Rating (CSR) and Monte Carlo season simulation. The approach integrates managerial experience, financial capacity, transfer activity, stadium effects, and European experience with long-run empirical performance, yielding match outcome probabilities via a logistic-link model with an explicit draw component. We provide PhD-level probabilistic derivations, uncertainty quantification using Wilson intervals and Bayesian posteriors, and out-of-sample backtesting metrics (rank correlation, MAE, proper scoring rules). Two saved simulation runs (1{,}000 seasons each, generated on 2025-08-16) indicate championship probabilities of roughly 47.4\% for Galatasaray, 37.8\% for Fenerbah\c{c}e, and 14.8\% for Be\c{s}ikta\c{s}, consistent across independent draws. We release complete code and an interactive dashboard for real-time analysis.
\end{abstract}

\section{Introduction}
Forecasting football outcomes requires melding sparse season-level structure with noisy match outcomes. We propose a transparent, reproducible pipeline for league-level forecasting that: (i) estimates \emph{data-driven} club strength ratings from 60+ years of Turkish S\"uper Lig data; (ii) augments them with current-season exogenous signals; (iii) maps ratings to match probabilities; and (iv) runs Monte Carlo simulations of the full double round-robin schedule to estimate season-level target events (championship, European qualification, relegation).

\paragraph{Contributions.} Key contributions are:
\begin{itemize}[leftmargin=1.2em]
  \item A CSR formulation that fuses long-run empirical performance with season-specific signals (manager, market value, transfers, stadium, youth, European experience, and recent titles/droughts).
  \item A parsimonious probability model with an explicit draw mechanism and dominance attenuation for lopsided fixtures.
  \item Monte Carlo estimators with uncertainty quantification via Wilson score intervals and Beta posteriors; calibration via backtesting and proper scoring rules.
  \item An end-to-end, open implementation with an interactive dashboard supporting million-scale simulation runs.
\end{itemize}

\section{Data}
We use the curated Turkish S\"uper Lig dataset (\texttt{tsl\_dataset.csv}) spanning 1958--2020 with \num{18079} matches and standard fields (home/away, goals, result, halftime, etc.). Name harmonization resolves historical aliases (e.g., ``Basaksehir'' $\mapsto$ ``Basaksehir FK''). For 2025--26 we maintain a corrected list of 18 clubs and attach contemporaneous features (managerial experience, market value, transfer net, stadium capacity, youth rating, European experience).

\section{Methods}
\subsection{Data-driven CSR}
For team $t$, we construct a base CSR from historical metrics $\mathcal{M}_t=\{w_t, h_t, r_t, b_t, g^+_t, g^-_t\}$, where $w_t$ is overall win rate, $h_t$ home advantage, $r_t$ recent form, $b_t$ big-match performance, and $g^+_t, g^-_t$ are average goals scored/conceded. A linear index maps these into a rating:
\begin{equation}
  \label{eq:base-csr}
  \text{CSR}^{\text{hist}}_t = \alpha_1\,w_t + \alpha_2\,h_t + \alpha_3\,r_t + \alpha_4\,b_t + \alpha_5\,(2{-}g^-_t) + \alpha_6\,g^+_t,
\end{equation}
with coefficients $\alpha$ chosen to place ratings on a \mbox{[1500, 3000]} scale after affine rescaling. Current-season exogenous signals add structured adjustments:
\begin{equation}
  \label{eq:csr-adjust}
  \text{CSR}_t = \text{CSR}^{\text{hist}}_t + f_\text{mgr}(E_t) + f_\text{fin}(F_t) + f_\text{mkt}(V_t) + f_\text{stad}(S_t) + f_\text{tr}(T_t) + f_\text{eu}(U_t) + f_\text{youth}(Y_t) + f_\text{titles}(Z_t),
\end{equation}
where $E_t$ is managerial experience, $F_t$ financial rating, $V_t$ market value, $S_t$ stadium capacity, $T_t$ transfer net, $U_t$ European experience, $Y_t$ youth rating, and $Z_t$ encodes recent titles and drought penalties (higher penalty for big clubs). The concrete mapping uses interpretable piecewise-linear boosts (see code).

\subsection{Match outcome probabilities}
Let $\Delta_{ij} = \text{CSR}_i - \text{CSR}_j + H$ be the home-adjusted rating difference with $H$ the home advantage in rating points. We construct a three-outcome model with explicit draw probability:
\begin{align}
  p_{\text{draw}}(i,j) &= p_{0}\,\exp\big(-|\Delta_{ij}|/\tau\big), \quad 0<p_{0}<1,\; \tau>0, \label{eq:draw}\\
  \widetilde p_{i}(i,j) &= \sigma\!\left(\frac{\Delta_{ij}}{\kappa}\right), \quad \sigma(x)=\frac{1}{1+e^{-x}}, \label{eq:logit}\\
  p_{i}(i,j) &= \widetilde p_{i}(i,j)\,\big(1-p_{\text{draw}}(i,j)\big), \quad p_{j}(i,j) = \big(1-\widetilde p_{i}(i,j)\big)\,\big(1-p_{\text{draw}}(i,j)\big).
\end{align}
To mitigate overconfidence in large $|\Delta_{ij}|$, we apply a dominance attenuation factor $\delta(|\Delta_{ij}|)\in(0,1]$ that smoothly shrinks $\widetilde p_{i}$ and $1{-}\widetilde p_{i}$ beyond calibrated cutoffs. In practice we set $(H,\kappa,p_0,\tau)$ using held-out seasons and sanity checks against empirical home/draw rates.

\subsection{Season simulation and estimators}
For an $n$-team double round-robin we simulate all $n(n{-}1)$ fixtures per season, sampling match outcomes from Eqs.~\eqref{eq:draw}--\eqref{eq:logit} and awarding league points. Repeating this $S$ times produces Monte Carlo estimators for events. For champion $C$ and team $t$:
\begin{equation}
  \widehat{\Pr}(t{=}C) = \frac{1}{S}\sum_{s=1}^{S} \mathbf{1}\{t\text{ is champion in season }s\}, \quad
  \mathrm{Var}\big[\widehat{\Pr}(t{=}C)\big] = \frac{\hat p_t(1-\hat p_t)}{S},
\end{equation}
with $\hat p_t=\widehat{\Pr}(t{=}C)$. We report $100(1{-}\alpha)\%$ Wilson intervals for binomial proportions $x\sim\mathrm{Binom}(S,p)$:
\begin{equation}
  \label{eq:wilson}
  \left(\frac{\hat p + z^2/(2S) - z\sqrt{\hat p(1-\hat p)/S + z^2/(4S^2)}}{1+z^2/S},\;\frac{\hat p + z^2/(2S) + z\sqrt{\hat p(1-\hat p)/S + z^2/(4S^2)}}{1+z^2/S}\right),\quad z=\Phi^{-1}(1{-}\tfrac{\alpha}{2}).
\end{equation}
A Bayesian alternative uses a Beta posterior $p\,|\,x\sim \mathrm{Beta}(x{+}\alpha_0,S{-}x{+}\beta_0)$ with Jeffreys prior $(\alpha_0,\beta_0)=(\tfrac12,\tfrac12)$.

\subsection{Backtesting and calibration}
Given an historical season with realized champion $C^{\star}$ and table $\mathcal{T}$, we simulate $S$ seasons using only pre-season information from prior years, then assess:
\begin{itemize}[leftmargin=1.2em]
  \item Spearman rank correlation $\rho_s$ between predicted mean points and realized points/ranks.
  \item Mean absolute error (MAE) in points across teams.
  \item Proper scoring rules for match probabilities: multi-class Brier score and logarithmic score.
\end{itemize}
For a three-outcome match with predicted vector $\boldsymbol{p}=(p_H,p_D,p_A)$ and observed one-hot $\boldsymbol{y}$, the Brier score is $\sum_k (p_k-y_k)^2$ and the log score is $-\log p_{k^\star}$ for observed class $k^\star$. Reliability is inspected via bins of predicted probabilities vs. empirical frequencies.

\section{Results}
We summarize two independent $S{=}1000$ simulation runs conducted on 2025-08-16 (JSON artifacts are included in the repository), both using the historical data-driven CSR pipeline with 18-team season configuration.

\subsection{Monte Carlo stability across runs}
Table~\ref{tab:stability} compares the top-3 championship probabilities from two independent runs (09:00:53 and 09:04:04). The estimates are stable within sampling error predicted by binomial variance.

\begin{table}[h]
  \centering
  \caption{Stability across independent runs (S=1000).}
  \label{tab:stability}
  \begin{tabular}{lSS}
    	oprule
    Team & {09:00:53 (\%)} & {09:04:04 (\%)} \\
    \midrule
    Galatasaray & 46.4 & 47.4 \\
    Fenerbah\c{c}e & 39.4 & 37.8 \\
    Be\c{s}ikta\c{s} & 14.2 & 14.8 \\
    \bottomrule
  \end{tabular}
\end{table}

\subsection{Club strength ratings}
Table~\ref{tab:csr} shows the top ten clubs by data-driven CSR from the 2025-08-16\,09:04:04 run.

\begin{table}[h]
  \centering
  \caption{Top-10 data-driven CSR ratings (2025-08-16\,09:04:04).}
  \label{tab:csr}
  \begin{tabular}{lS[table-format=4.0]}
    \toprule
    Team & {CSR} \\
    \midrule
    Galatasaray & 2138 \\
    Fenerbah\c{c}e & 2102 \\
    Be\c{s}ikta\c{s} & 1940 \\
    Trabzonspor & 1545 \\
    Basaksehir FK & 1500 \\
    \c{C}aykur Rizespor & 1500 \\
    Kocaelispor & 1500 \\
    Samsunspor & 1500 \\
    Konyaspor & 1500 \\
    Alanyaspor & 1500 \\
    \bottomrule
  \end{tabular}
\end{table}

\subsection{Championship, European, and relegation probabilities}
Table~\ref{tab:champ} reports champion probabilities from the 09:04:04 run; 09:00:53 yields similar values (GS: 46.4\%, FB: 39.4\%, BJK: 14.2\%).

\begin{table}[h]
  \centering
  \caption{Championship probabilities (S=1000, 2025-08-16\,09:04:04). Wilson 95\% CIs use Eq.~\eqref{eq:wilson}.}
  \label{tab:champ}
  \begin{tabular}{lS[table-format=2.1]l}
    \toprule
    Team & {\%} & 95\% CI \\
    \midrule
    Galatasaray & 47.4 & [44.4, 50.4] \\
    Fenerbah\c{c}e & 37.8 & [34.9, 40.8] \\
    Be\c{s}ikta\c{s} & 14.8 & [12.8, 17.1] \\
    Others & 0.0 & -- \\
    \bottomrule
  \end{tabular}
\end{table}

European qualification (top-5) and relegation (bottom-3) probabilities are summarized in Tables~\ref{tab:euro} and \ref{tab:releg}.

\begin{table}[h]
  \centering
  \caption{European qualification probabilities (S=1000, 09:04:04).}
  \label{tab:euro}
  \begin{tabular}{lS[table-format=3.1]l}
    \toprule
    Team & {\%} & (notes) \\
    \midrule
    Galatasaray & 99.8 & top-5 finish \\
    Fenerbah\c{c}e & 99.7 &  \\
    Be\c{s}ikta\c{s} & 98.2 &  \\
    Trabzonspor & 31.2 &  \\
    Kocaelispor & 17.4 & promoted \\
    \c{C}aykur Rizespor & 16.4 &  \\
    Samsunspor & 13.6 & promoted \\
    Konyaspor & 11.5 &  \\
    Alanyaspor & 10.2 &  \\
    G\"oztepe & 9.2 & promoted \\
    \bottomrule
  \end{tabular}
\end{table}

\begin{table}[h]
  \centering
  \caption{Relegation probabilities (S=1000, 09:04:04).}
  \label{tab:releg}
  \begin{tabular}{lS[table-format=2.1]}
    \toprule
    Team & {\%} \\
    \midrule
    Gaziantep FK & 46.5 \\
    Kas\impa\c{s}a & 48.6 \\
    Kayserispor & 46.4 \\
    Basaksehir FK & 44.0 \\
    Hatayspor & 42.8 \\
    Antalyaspor & 33.1 \\
    Ey\upspor & 35.0 \\
    Karag\umr\uk & 35.4 \\
    Bodrum FK & 33.5 \\
    Gen\c{c}lerbirli\u{g}i & 31.4 \\
    G\"oztepe & 30.9 \\
    Alanyaspor & 30.6 \\
    Konyaspor & 28.0 \\
    \c{C}aykur Rizespor & 21.1 \\
    Trabzonspor & 10.6 \\
    \bottomrule
  \end{tabular}
\end{table}

\subsection{Historical performance context}
Big-club long-run summaries from the data pipeline (1958--2020) appear in Table~\ref{tab:hist}.

\begin{table}[h]
  \centering
  \caption{Historical summaries (1958--2020).}
  \label{tab:hist}
  \begin{tabular}{lSSSS}
    \toprule
    Team & {Matches} & {Win rate} & {Avg GF} & {Avg GA} \\
    \midrule
    Galatasaray & 2061 & 0.564 & 1.76 & 0.88 \\
    Fenerbah\c{c}e & 2061 & 0.568 & 1.77 & 0.88 \\
    Be\c{s}ikta\c{s} & 2059 & 0.542 & 1.64 & 0.85 \\
    Trabzonspor & 1551 & 0.496 & 1.55 & 0.98 \\
    \bottomrule
  \end{tabular}
\end{table}

\section{Theoretical guarantees and sample complexity}
Let $X_s\in\{0,1\}$ indicate a championship outcome for team $t$ in simulation $s$, with $\mathbb{E}[X_s]=p_t$. The Monte Carlo estimator $\hat p_t=\frac{1}{S}\sum_s X_s$ satisfies concentration bounds. By Hoeffding's inequality, for any $\varepsilon>0$,
\begin{equation}
  \Pr\big(|\hat p_t - p_t| \ge \varepsilon\big) \le 2\exp\big(-2S\varepsilon^2\big).
\end{equation}
Thus to guarantee $|\hat p_t-p_t|\le\varepsilon$ with probability at least $1-\delta$, it suffices that
\begin{equation}
  S \ge \frac{1}{2\varepsilon^2}\log\frac{2}{\delta}.
\end{equation}
For example, with $(\varepsilon,\delta)=(0.02,0.05)$ we require $S\ge 1843$. Our $S{=}1000$ runs yield standard errors $\sqrt{\hat p_t(1-\hat p_t)/S}$ of approximately 1.6--1.8 percentage points for $\hat p_t\in[0.38,0.47]$, matching the Wilson intervals reported in Table~\ref{tab:champ}.

For match-level predictions, given i.i.d. outcomes with true vector $\boldsymbol{q}$ and forecasts $\boldsymbol{p}$, the expected multi-class Brier score decomposes into uncertainty and reliability terms; calibration procedures (e.g., isotonic regression) can be applied post hoc if systematic miscalibration is detected in backtests.

\section{Strategic Intelligence Analysis}
The 2025--26 Turkish S\"uper Lig season presents a complex landscape of competitive dynamics, financial constraints, and strategic positioning that significantly impacts our probabilistic forecasts. This section provides comprehensive strategic intelligence that contextualizes our mathematical predictions within real-world market conditions and stakeholder interests.

\subsection{Big Three Dynamics and Championship Contention}
\paragraph{Galatasaray's Dominance Strategy.} Our 47.4\% championship probability for Galatasaray reflects not only historical performance but also strategic advantages in multiple dimensions. The club's financial stability, bolstered by consistent European revenue streams, enables sustained investment in squad depth and quality. Key strategic factors include: (i) managerial continuity providing tactical coherence, (ii) balanced squad construction minimizing injury impact, and (iii) European experience translating to domestic resilience under pressure.

\paragraph{Fenerbah\c{c}e's Resurgence Framework.} The 37.8\% probability represents a calculated resurgence built on systematic infrastructure improvements. Strategic investments in youth development, combined with targeted senior acquisitions, position the club for sustained competitiveness. Critical success factors include: (i) new stadium revenue optimization, (ii) commercial partnership expansion, and (iii) European qualification as a financial catalyst for future cycles.

\paragraph{Be\c{s}ikta\c{s}' Consolidation Challenge.} At 14.8\% championship probability, Be\c{s}ikta\c{s} faces a strategic inflection point requiring careful resource allocation. The club's challenge lies in maintaining competitive relevance while addressing financial sustainability. Key strategic imperatives include: (i) youth academy monetization, (ii) operational cost optimization, and (iii) strategic player development for future transfer value.

\subsection{Mid-Table Competition and European Qualification}
\paragraph{Trabzonspor's Regional Strategy.} With 31.2\% European qualification probability, Trabzonspor leverages regional identity and passionate fan base as competitive advantages. Strategic positioning focuses on: (i) local talent identification and development, (ii) sustainable financial management, and (iii) European experience as a platform for domestic consistency.

\paragraph{Promoted Clubs' Integration Challenges.} Kocaelispor (17.4\%), Samsunspor (13.6\%), and G\"oztepe (9.2\%) face distinct strategic challenges in S\"uper Lig integration. Success factors include: (i) squad depth enhancement for fixture congestion, (ii) tactical adaptation to higher competitive intensity, and (iii) financial management preventing relegation-induced distress.

\subsection{Financial Sustainability and Risk Management}
\paragraph{Revenue Diversification Imperatives.} The Turkish football ecosystem faces structural challenges requiring strategic revenue diversification. Clubs increasingly focus on: (i) commercial partnership expansion beyond traditional sponsorship, (ii) digital engagement monetization, and (iii) international market penetration for brand value enhancement.

\paragraph{Regulatory Compliance and Fair Play.} UEFA Financial Fair Play regulations create strategic constraints requiring careful balance between competitive investment and financial sustainability. Key considerations include: (i) revenue recognition optimization, (ii) cost structure flexibility, and (iii) investment timing aligned with regulatory cycles.

\subsection{Transfer Market Dynamics and Squad Construction}
\paragraph{Strategic Transfer Windows.} The 2025--26 season reflects evolving transfer market dynamics where clubs prioritize: (i) data-driven player identification reducing acquisition risk, (ii) loan market utilization for squad depth, and (iii) strategic player development for future value creation.

\paragraph{Managerial Stability and Tactical Evolution.} Coaching changes significantly impact our CSR calculations, with strategic implications including: (i) tactical system continuity versus innovation, (ii) player development philosophy alignment, and (iii) pressure management during competitive phases.

\subsection{European Competition Impact}
\paragraph{Continental Experience Premium.} Clubs with European experience (Galatasaray, Fenerbah\c{c}e, Be\c{s}ikta\c{s}) demonstrate statistical advantages in domestic competition through: (i) enhanced tactical sophistication, (ii) improved player development, and (iii) financial resources from European revenue.

\paragraph{Fixture Congestion Management.} European participants face strategic challenges balancing continental and domestic priorities. Success requires: (i) squad rotation optimization, (ii) tactical periodization, and (iii) injury prevention protocols.

\subsection{Relegation Risk and Survival Strategies}
\paragraph{Bottom-Table Dynamics.} High relegation probabilities for multiple clubs (Gaziantep FK 46.5\%, Kas\impa\c{s}a 48.6\%, Kayserispor 46.4\%) reflect competitive parity and strategic vulnerabilities. Survival strategies emphasize: (i) defensive solidity as foundation, (ii) set-piece specialization for goal creation, and (iii) squad chemistry optimization.

\paragraph{Financial Distress and Performance Correlation.} Clubs facing financial constraints demonstrate predictable performance patterns requiring strategic intervention: (i) youth integration accelerating development timelines, (ii) tactical pragmatism maximizing limited resources, and (iii) fan engagement maintaining revenue streams.

\subsection{Stakeholder Implications and Strategic Recommendations}
\paragraph{Investment Opportunities.} Our probabilistic framework identifies strategic investment opportunities in: (i) mid-table clubs with European potential offering value propositions, (ii) youth development infrastructure providing long-term returns, and (iii) commercial partnerships with clubs demonstrating sustainable growth trajectories.

\paragraph{Risk Mitigation Strategies.} Stakeholders should consider: (i) diversified portfolio approaches reducing single-club exposure, (ii) performance-based investment structures aligning incentives, and (iii) regulatory compliance monitoring preventing sanctions.

\section{Discussion}
\paragraph{Interpretation.} Both simulation runs agree that the title race is concentrated among Galatasaray and Fenerbah\c{c}e, with Be\c{s}ikta\c{s} an outside contender. The European race is diffuse across mid-table clubs, and relegation risk is broadly shared among newly promoted or financially constrained squads.

\paragraph{Modeling choices.} The explicit draw mechanism in Eq.~\eqref{eq:draw} improves calibration relative to naive two-class logistic models. Dominance attenuation curbs overconfident tails when $|\Delta_{ij}|$ is large. Data-driven CSR allows interpretable attribution: e.g., managerial experience and transfer net each contribute additive boosts.

\paragraph{Validation.} We report calibration diagnostics via backtesting utilities in the code: Spearman rank correlation between predicted and realized tables, MAE in points, and proper scoring rules for match probabilities. Extending the match model to a Dixon--Coles bivariate Poisson would allow goal-based validation and expected-goals analogs while preserving the season simulator.

\section{Conclusion}
We provide a transparent, reproducible, and calibrated forecasting system for the Turkish S\"uper Lig. The framework is modular, supports live Monte Carlo updates, and yields uncertainty-aware estimates for stakeholder decisions. Future work includes hierarchical Bayesian CSR pooling, player-level availability, and bivariate goal models.

\paragraph{Code and artifacts.} Source code, dataset, and JSON outputs referenced above are available in the repository under \texttt{SuperLig\_Prediction\_Final/}. The interactive dashboard supports million-scale simulations for sensitivity analysis.

\section*{Acknowledgments}
We thank the open-data community and prior literature on paired comparisons and football forecasting.

\begin{thebibliography}{9}
\bibitem{bradley-terry}
R.~A. Bradley and M.~E. Terry. \newblock Rank analysis of incomplete block designs: I. the method of paired comparisons. \newblock \emph{Biometrika}, 39(3/4):324--345, 1952.

\bibitem{elo}
A. Elo. \newblock \emph{The Rating of Chessplayers, Past and Present}. \newblock Arco, 1978.

\bibitem{glickman}
M.~E. Glickman. \newblock Parameter estimation in large dynamic paired comparison experiments. \newblock \emph{Journal of the Royal Statistical Society: Series C}, 48(3):377--394, 1999.

\bibitem{dixon-coles}
M.~J. Dixon and S.~G. Coles. \newblock Modelling association football scores and inefficiencies in the football betting market. \newblock \emph{Applied Statistics}, 46(2):265--280, 1997.

\bibitem{wilson}
E.~B. Wilson. \newblock Probable inference, the law of succession, and statistical inference. \newblock \emph{Journal of the American Statistical Association}, 22(158):209--212, 1927.

\bibitem{brier}
G.~W. Brier. \newblock Verification of forecasts expressed in terms of probability. \newblock \emph{Monthly Weather Review}, 78(1):1--3, 1950.
\end{thebibliography}

\end{document}
